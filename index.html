<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Anonim Sohbet</title>
  <style>
    body{margin:0;font-family:"Courier New",monospace;background:#000;color:#eee}
    .menubar{display:flex;justify-content:space-between;align-items:center;background:#111;padding:6px;border-bottom:1px solid #333}
    .menubar button{background:#222;border:1px solid #444;color:#eee;padding:4px 10px;cursor:pointer}
    .layout{display:grid;grid-template-columns:240px 1fr 220px;height:calc(100vh - 38px)}
    .pane{background:#111;border-right:1px solid #333;display:flex;flex-direction:column;min-height:0}
    .pane-right{border-left:1px solid #333}
    .pane-title{padding:6px;font-weight:bold;border-bottom:1px solid #333}
    .list{list-style:none;margin:0;padding:6px;overflow:auto}
    .list li{padding:4px 6px;display:flex;align-items:center;gap:6px;cursor:pointer;user-select:none}
    .list li:hover{background:#0a0a0a}
    .list li.sponsor{color:#4af;font-weight:bold}
    .center{display:flex;flex-direction:column;min-height:0}
    .topic{padding:6px;text-align:center;border-bottom:1px solid #333;color:#aaa}
    .messages{flex:1;overflow:auto;padding:6px;font-size:13px;background:#000}
    .time{color:#888;font-size:11px;margin-right:6px}
    .info{color:#888;text-align:center;font-style:italic;margin:4px 0}
    .typing{color:#4af;font-size:12px;margin:2px 0;font-style:italic}
    .inputbar{display:flex;border-top:1px solid #333;background:#111;gap:6px;padding:6px}
    .inputbar input{flex:1;background:#000;color:#eee;border:1px solid #333;padding:6px}
    .inputbar button{background:#222;color:#eee;border:1px solid #333;padding:6px}
    .avatar{font-size:16px}
    .star{cursor:pointer;color:#666;margin-left:auto}
    .star.following{color:gold}
    .hint{color:#888;font-size:12px;padding:6px;border-top:1px solid #222}

    @media(max-width:768px){
      .layout{grid-template-columns:1fr}
      .pane,.pane-right{display:none}
      .menubar .mobile-toggle{display:inline-block}
      #mobileMenu{display:block;}
    }
    @media(min-width:769px){
      .menubar .mobile-toggle{display:none}
      #mobileMenu{display:none !important;}
    }

    #mobileMenu{
      position:fixed;top:0;left:-260px;width:260px;height:100%;
      background:#111;border-right:1px solid #333;transition:left .3s;z-index:1000;padding:6px
    }
    #mobileMenu.open{left:0}
    #mobileMenu .closeBtn{background:#222;border:1px solid #444;color:#eee;width:100%;margin-bottom:8px;padding:6px;cursor:pointer}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:2000}
    .modal.open{display:flex}
    .modal-content{background:#111;padding:14px;border:1px solid #333;display:grid;gap:8px;min-width:300px;max-width:92vw;position:relative}
    .modal-content input,.modal-content select,.modal-content textarea{background:#000;color:#eee;border:1px solid #333;padding:6px}
    .modal-close{position:absolute;top:4px;right:4px;background:#222;color:#eee;border:1px solid #444;cursor:pointer;padding:2px 6px}
    .section{border-top:1px solid #222;margin-top:6px;padding-top:6px}
    .muted{color:#aaa;font-size:12px}

    /* Emoji picker (mevcut) */
    #emojiBox{position:absolute;display:none;z-index:3000}

    /* ==== HOBÄ° CHIPS (YATAY) ==== */
    #hobbyList{
      display:flex; flex-wrap:wrap; gap:8px; align-items:flex-start;
      max-width:min(900px,90vw);
    }
    .hobby-chip{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 8px;border:1px solid #333;border-radius:8px;
      background:#0a0a0a;white-space:nowrap;font-size:13px;
    }
    .hobby-chip button{
      background:#222;border:1px solid #444;color:#eee;
      padding:2px 6px;border-radius:6px;cursor:pointer;
    }
    #hobbyPicked{
      display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;
    }
    .picked-chip{
      background:#1a1a1a;border:1px solid #333;border-radius:8px;
      padding:4px 8px;font-size:12px;
    }
  </style>

  <!-- Emoji Picker lib -->
  <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</head>
<body>
  <div class="menubar">
    <button class="mobile-toggle" onclick="toggleMobileMenu()">â˜° MenÃ¼</button>
    <span id="authStatus">Anonim</span>
    <div>
      <button id="btnFeedback">Ã–neri</button>
      <button id="btnLogin">GiriÅŸ</button>
      <button id="btnProfile" style="display:none">Profil DÃ¼zenle</button>
      <button id="btnLogout" style="display:none">Ã‡Ä±kÄ±ÅŸ</button>
    </div>
  </div>

  <div class="layout">
    <aside class="pane">
      <div class="pane-title">Sponsorlu Kanallar</div>
      <ul id="sponsorList" class="list"></ul>

      <div class="pane-title">Genel Kanallar</div>
      <ul id="channelList" class="list"></ul>

      <div class="pane-title">Favori KanallarÄ±m</div>
      <ul id="favList" class="list"></ul>

      <div id="addChannelBox" style="display:none;padding:6px;border-top:1px solid #333">
        <input id="newChannel" placeholder="#kanal-adÄ±" style="width:100%;margin-bottom:4px"/>
        <button id="btnAddChannel" style="width:100%">Ekle</button>
        <div class="hint muted">Kendi kanalÄ±nÄ± ekle (#konya gibi).</div>
      </div>
    </aside>

    <main class="center">
      <div id="topic" class="topic">#genel</div>
      <div id="messages" class="messages"></div>
      <div id="typingArea"></div>
      <form id="form" class="inputbar" autocomplete="off">
        <input id="input" placeholder="Mesaj yaz..." maxlength="1000"/>
        <button>GÃ¶nder</button>
        <button type="button" id="btnEmoji" title="Emoji">ðŸ˜€</button>
      </form>
      <emoji-picker id="emojiBox"></emoji-picker>
    </main>

    <aside class="pane pane-right">
      <div class="pane-title">KullanÄ±cÄ±lar</div>
      <ul id="userList" class="list"></ul>
      <div class="pane-title">Takip Ettiklerim</div>
      <ul id="followList" class="list"></ul>
    </aside>
  </div>

  <!-- ðŸ” Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="loginModal.classList.remove('open')">âœ–</button>
      <h3>GiriÅŸ / KayÄ±t</h3>
      <input id="identifier" placeholder="Email veya Telefon"/>
      <input id="password" type="password" placeholder="Åžifre"/>
      <div class="section">
        <button id="doLogin">GiriÅŸ</button>
        <button id="doRegister">KayÄ±t</button>
      </div>
      <div class="muted">GiriÅŸ yapmadan anonim sohbet edebilirsin; fakat DM, arkadaÅŸ ekleme ve kanal ekleme iÃ§in giriÅŸ gerekir.</div>
    </div>
  </div>

  <!-- ðŸ‘¤ Profil Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="profileModal.classList.remove('open')">âœ–</button>
      <h3>Profil DÃ¼zenle</h3>
      <input id="firstName" placeholder="Ä°sim"/>
      <input id="lastName" placeholder="Soyisim"/>
      <select id="gender">
        <option value="">Cinsiyet</option>
        <option value="erkek">Erkek</option>
        <option value="kadÄ±n">KadÄ±n</option>
      </select>
      <input id="birth" placeholder="DoÄŸum Tarihi"/>
      <input id="country" placeholder="Ãœlke"/>
      <input id="city" placeholder="Åžehir"/>
      <button id="saveProfile">Kaydet</button>
      <div class="muted">Cinsiyete gÃ¶re avatar otomatik ayarlanÄ±r (ðŸ‘¨ / ðŸ‘©).</div>
      <div class="section">
        <button type="button" id="btnHobbies">Ä°lgi AlanlarÄ±</button>
      </div>
    </div>
  </div>

  <!-- ðŸŽ¯ Hobiler Modal -->
  <div id="hobbyModal" class="modal">
    <div class="modal-content" style="max-height:70vh;overflow:auto">
      <button onclick="hobbyModal.classList.remove('open')" class="modal-close">âœ–</button>
      <h3>Ä°lgi AlanlarÄ±</h3>
      <div id="hobbyList"></div>
      <div style="margin-top:8px">
        <b>SeÃ§ilenler:</b>
        <div id="hobbyPicked"></div>
      </div>
      <button id="saveHobbies">Kaydet</button>
      <div class="muted">SeÃ§tiklerine gÃ¶re Ã¶nerilen kanallar otomatik eklenecek.</div>
    </div>
  </div>

  <!-- ðŸ’¡ Ã–neri / Feedback Modal -->
  <div id="feedbackModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" onclick="feedbackModal.classList.remove('open')">âœ–</button>
      <h3>Ã–neri GÃ¶nder</h3>
      <textarea id="feedbackText" placeholder="Ã–nerini / isteÄŸini yaz..."
        style="width:60vw;max-width:600px;height:120px"></textarea>
      <div class="section">
        <button id="sendFeedback">GÃ¶nder</button>
      </div>
      <div class="muted">TeÅŸekkÃ¼rler! DÃ¼ÅŸÃ¼nceleriniz geliÅŸtirmemize yardÄ±mcÄ± olur.</div>
    </div>
  </div>

  <!-- app.js (mevcut mantÄ±ÄŸÄ±n) -->
  <script src="app.js"></script>

  <!-- === Ä°nce ayar: giriÅŸ & profil & hobiler davranÄ±ÅŸÄ± + yatay hobby chips === -->
  <script>
    // Mobil menÃ¼
    function toggleMobileMenu(force){
      const el=document.getElementById("mobileMenu");
      if(!el) return;
      if(force===false){el.classList.remove("open");return;}
      el.classList.toggle("open");
    }

    // app.js bazen "hobbiesModal" ismini arÄ±yor; aynÄ± modala iÅŸaret etsin:
    window.hobbiesModal = document.getElementById('hobbyModal');

    // GiriÅŸ butonuna basÄ±nca: Hem login modalÄ± hem hobiler modalÄ± aÃ§ (isteÄŸin gibi "direkt").
    // (Ä°stersen sadece baÅŸarÄ±lÄ± giriÅŸten sonra aÃ§Ä±lmasÄ± iÃ§in bu satÄ±rÄ± deÄŸiÅŸtirebiliriz.)
    const btnLogin = document.getElementById('btnLogin');
    const loginModal = document.getElementById('loginModal');
    const hobbyModal = document.getElementById('hobbyModal');
    if(btnLogin && loginModal && hobbyModal){
      btnLogin.onclick = ()=>{
        loginModal.classList.add('open');
        hobbyModal.classList.add('open');
        renderHobbyChips(); // ilk aÃ§Ä±lÄ±ÅŸta Ã§iz
      };
    }

    // Profil butonu (giriÅŸ yaptÄ±ysa app.js zaten gÃ¶rÃ¼nÃ¼r yapÄ±yor, burada sadece modal aÃ§Ä±yoruz)
    const btnProfile = document.getElementById('btnProfile');
    const profileModal = document.getElementById('profileModal');
    if(btnProfile && profileModal){
      btnProfile.onclick = ()=> profileModal.classList.add('open');
    }

    // HOBÄ°LER: Yatay chips + â€œ+â€ ile kaybolsun -> seÃ§ilenlere eklensin
    const ALL_HOBBIES_FALLBACK = [
      "Futbol","Basketbol","Voleybol","KoÅŸu","Fitness","YÃ¼zme","Tenis","MMA","DalÄ±ÅŸ","Kamp",
      "Bilgisayar OyunlarÄ±","Mobil Oyunlar","CS:GO","LoL","Valorant","SatranÃ§",
      "Film","Dizi","Netflix","Anime","Belgesel",
      "MÃ¼zik","Rock","Rap","Klasik","Piyano","Gitar","DJ",
      "Kitap","Roman","Åžiir","KiÅŸisel GeliÅŸim","Felsefe",
      "Yemek","TatlÄ±","Kahve","Ã‡ay","BarbekÃ¼","Vegan",
      "Teknoloji","YazÄ±lÄ±m","Yapay ZekÃ¢","Siber GÃ¼venlik","Kripto",
      "Seyahat","FotoÄŸraf","DoÄŸa","Resim","Heykel","TasarÄ±m","Moda",
      "Araba","Motosiklet","Drone","RC","Model",
      "Dil Ã–ÄŸrenme","Ä°ngilizce","Almanca","Ä°spanyolca","TÃ¼rkÃ§e",
      "GiriÅŸimcilik","Pazarlama","E-ticaret","YatÄ±rÄ±m","Borsa",
      "SaÄŸlÄ±k","Psikoloji","Meditasyon","Yoga","Mindfulness"
    ];

    function getAllHobbies(){
      // app.js iÃ§inden ALL_HOBBIES varsa onu kullan, yoksa fallback
      return (window.ALL_HOBBIES && Array.isArray(window.ALL_HOBBIES) ? window.ALL_HOBBIES : ALL_HOBBIES_FALLBACK).slice();
    }
    function getPickedSet(){
      try{
        const arr = JSON.parse(localStorage.getItem('hobbies')||'[]');
        return new Set(arr);
      }catch{ return new Set(); }
    }
    function savePickedSet(set){
      localStorage.setItem('hobbies', JSON.stringify([...set]));
    }

    function renderHobbyChips(){
      const list = document.getElementById('hobbyList');
      const pickedWrap = document.getElementById('hobbyPicked');
      if(!list || !pickedWrap) return;

      const picked = getPickedSet();
      list.innerHTML = "";
      pickedWrap.innerHTML = "";

      // SeÃ§ilenleri Ã¼stte rozet gibi gÃ¶ster
      [...picked].forEach(h=>{
        const chip=document.createElement('div');
        chip.className='picked-chip';
        chip.textContent=h;
        pickedWrap.appendChild(chip);
      });

      // SeÃ§ilmemiÅŸ (gÃ¶sterilecek) hobiler
      const all = getAllHobbies();
      const remaining = all.filter(h=>!picked.has(h));

      remaining.forEach(h=>{
        const chip=document.createElement('div');
        chip.className='hobby-chip';
        chip.innerHTML = `<span>${h}</span>`;
        const plus=document.createElement('button');
        plus.textContent = "+";
        plus.title = "Ekle";
        plus.onclick = ()=>{
          picked.add(h);
          savePickedSet(picked);
          // anÄ±nda listeden kaybolsun:
          chip.remove();
          // seÃ§ilenlere rozeti ekle
          const sel=document.createElement('div');
          sel.className='picked-chip';
          sel.textContent=h;
          pickedWrap.appendChild(sel);
        };
        chip.appendChild(plus);
        list.appendChild(chip);
      });
    }

    // â€œÄ°lgi AlanlarÄ±â€ butonu da bu yeni yatay gÃ¶rÃ¼nÃ¼me aÃ§sÄ±n
    const btnHobbies = document.getElementById('btnHobbies');
    if(btnHobbies){
      btnHobbies.onclick = ()=>{
        hobbyModal.classList.add('open');
        renderHobbyChips();
      };
    }

    // Kaydet -> sadece localStorageâ€™a yazÄ±ldÄ± (app.js varsa kendi /profile/update akÄ±ÅŸÄ±n yine Ã§alÄ±ÅŸÄ±r)
    const saveHobbiesBtn = document.getElementById('saveHobbies');
    if(saveHobbiesBtn){
      saveHobbiesBtn.onclick = ()=>{
        // Burada zaten her + tÄ±klamada kaydediyoruz; istersen ek iÅŸlem ekleyebilirsin
        alert("Ä°lgi alanlarÄ± kaydedildi.");
        hobbyModal.classList.remove('open');
      };
    }
  </script>
</body>
</html>
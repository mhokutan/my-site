<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>🚀 Gelişmiş Sohbet Uygulaması - Lokasyon Bazlı</title>
    <link rel="stylesheet" href="modern-styles.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Modern Menubar -->
  <div class="menubar">
        <h1>🚀 Gelişmiş Sohbet</h1>
        <div class="menubar-buttons">
      <button id="btnLogin" data-translate="login">Giriş</button>
            <button id="btnProfile" data-translate="profile" style="display:none;">Profil</button>
            <button id="btnLocation" onclick="openLocationModal()" data-translate="location">📍 Lokasyon</button>
            <button id="btnSponsor" data-translate="sponsor">💰 Sponsor</button>
            <button id="btnCreateChannel" data-translate="createChannel">➕ Kanal Oluştur</button>
            <button id="btnDonate">☕ Kahve İkram Et</button>
            <button id="btnMenu">☰</button>
  </div>
    </div>

    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <!-- Kullanıcı Bilgisi -->
            <div class="user-info">
                <div class="user-avatar">👤</div>
                <div class="user-details">
                    <div class="user-name" id="userName">Anonim</div>
                    <div class="user-status" id="userStatus">Çevrimiçi</div>
                    <div class="location-indicator" id="locationIndicator" style="display:none;">
                        <span id="currentLocation">Lokasyon algılanıyor...</span>
                    </div>
                    <button id="btnLogin" onclick="openLoginModal()" style="margin-top: 10px; padding: 8px 16px; background: var(--brand); color: white; border: none; border-radius: 4px; cursor: pointer;" data-translate="loginBtn">Giriş</button>
    </div>
  </div>

            <!-- Kanallar -->
            <div class="channels-section">
                <h3 data-translate="sponsorChannelsTitle">💰 Sponsor Kanallar</h3>
                <ul class="list" id="sponsorList">
                    <!-- Sponsor kanallar buraya yüklenecek -->
                </ul>

                <h3 data-translate="generalChannelsTitle">🌐 Genel Kanallar</h3>
                <ul class="list" id="channelList">
                    <!-- Lokasyon bazlı kanallar buraya yüklenecek -->
                </ul>

                <h3 data-translate="favoriteChannelsTitle">⭐ Favori Kanallarım</h3>
                <ul class="list" id="followList">
                    <!-- Takip edilen kanallar -->
                </ul>
  </div>

            <!-- Kullanıcılar -->
            <div class="users-section">
                <h3 data-translate="users">👥 Kullanıcılar</h3>
                <ul class="list" id="userList">
                    <!-- Aktif kullanıcılar -->
                </ul>
      </div>
      
            <!-- Kanal Ekleme -->
            <div class="channel-add">
                <input type="text" id="newChannel" placeholder="Yeni kanal adı (#kanal)" data-placeholder="channelName">
                <button id="btnAddChannel" data-translate="addBtn">Ekle</button>
    </div>
  </div>

        <!-- Ana İçerik -->
        <div class="main-content">
            <div class="chat-container">
                <!-- Kanal Başlığı -->
                <div class="channel-header">
                    <h2 id="currentChannel">#genel</h2>
                    <div class="channel-info">
                        <span id="userCount">0 kullanıcı</span>
                        <span id="channelDescription">Genel sohbet kanalı</span>
                    </div>
      </div>
      
                <!-- Mesajlar -->
                <div class="messages" id="messages">
                    <div class="info">🚀 Gelişmiş sohbet uygulamasına hoş geldiniz!</div>
                    <div class="info">📍 Lokasyonunuz otomatik algılanıyor...</div>
                    <div class="info">🌍 Dil otomatik olarak ayarlanıyor...</div>
      </div>
      
                <!-- Yazıyor Göstergesi -->
                <div class="typing-area" id="typingArea"></div>

                <!-- Mesaj Gönderme -->
                <div class="input-area">
                    <input type="text" id="messageInput" placeholder="Mesajınızı yazın..." data-placeholder="messageInput">
                    <button id="btnSend">Gönder</button>
      </div>
    </div>
      </div>
    </div>

    <!-- Mobil Menü -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <h3>Menü</h3>
            <button class="mobile-menu-close" onclick="toggleMobileMenu()">✖</button>
  </div>

        <div class="mobile-menu-content">
            <!-- Mobil Kanallar -->
            <div class="mobile-channels">
                <h4 data-translate="sponsorChannelsTitle">💰 Sponsor Kanallar</h4>
                <ul class="mobile-list" id="sponsorListMobile"></ul>

                <h4 data-translate="generalChannelsTitle">🌐 Genel Kanallar</h4>
                <ul class="mobile-list" id="channelListMobile"></ul>

                <h4 data-translate="favoriteChannelsTitle">⭐ Favori Kanallarım</h4>
                <ul class="mobile-list" id="followListMobile"></ul>
      </div>
      
            <!-- Mobil Kullanıcılar -->
            <div class="mobile-users">
                <h4 data-translate="users">👥 Kullanıcılar</h4>
                <ul class="mobile-list" id="userListMobile"></ul>
      </div>
      
            <!-- Mobil Kanal Ekleme -->
            <div class="mobile-channel-add">
                <input type="text" id="newChannelMobile" placeholder="Yeni kanal adı" data-placeholder="channelName">
                <button id="btnAddChannelMobile" data-translate="addBtn">Ekle</button>
      </div>
      </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 data-translate="loginTitle">Giriş / Kayıt</h3>
                <button class="modal-close" onclick="closeLoginModal()">✖</button>
  </div>
            <div class="modal-body">
                <input type="text" id="identifier" placeholder="Email veya Telefon" data-placeholder="email">
                <input type="password" id="password" placeholder="Şifre" data-placeholder="password">
                <label>
                    <input type="checkbox" id="rememberMe"> 
                    <span data-translate="rememberMe">Beni Hatırla</span>
                </label>
      </div>
            <div class="modal-footer">
                <button onclick="doLogin()" data-translate="loginBtn">Giriş</button>
                <button onclick="doRegister()" data-translate="registerBtn">Kayıt</button>
    </div>
    </div>
  </div>

    <!-- Scripts -->
  <script src="translations.js"></script>
    <script src="location-manager.js"></script>
  <script src="app.js"></script>
  <script src="advanced-features.js"></script>
  
  <script>
        // Sayfa yüklendiğinde çalışacak fonksiyonlar
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 Sayfa yüklendi, lokasyon sistemi başlatılıyor...');
            
            // Lokasyon göstergesini güncelle
            updateLocationIndicator();
            
            // Menü butonları
            document.getElementById('btnMenu').onclick = toggleMobileMenu;
            document.getElementById('btnLocation').onclick = showLocationModal;
            document.getElementById('btnSponsor').onclick = () => {
                if (window.sponsorSystem) {
                    window.sponsorSystem.showSponsorCreateModal();
                }
            };
            
            // Sponsor sistemi başlat
            if (window.SponsorChannelSystem) {
                window.sponsorSystem = new window.SponsorChannelSystem();
            }
        });

        // Lokasyon göstergesini güncelle
        function updateLocationIndicator() {
            const locationData = JSON.parse(localStorage.getItem('userLocation') || '{}');
            const locationIndicator = document.getElementById('locationIndicator');
            const currentLocation = document.getElementById('currentLocation');
            
            if (locationData.city && locationData.country) {
                locationIndicator.style.display = 'inline-flex';
                currentLocation.textContent = `${locationData.city}, ${locationData.country}`;
            }
        }

        // Lokasyon modal'ı göster
        function showLocationModal() {
            const locationData = JSON.parse(localStorage.getItem('userLocation') || '{}');
            alert(`📍 Mevcut Lokasyon:\n${locationData.city || 'Bilinmiyor'}, ${locationData.country || 'Bilinmiyor'}\n\n🌍 Dil: ${localStorage.getItem('selectedLanguage') || 'TR'}\n\nLokasyon otomatik olarak algılanmıştır.`);
        }

        // Mobil menü toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('open');
        }

        // Lokasyon değiştiğinde göstergeleri güncelle
        window.addEventListener('storage', (e) => {
            if (e.key === 'userLocation') {
                updateLocationIndicator();
            }
        });
  </script>
</body>
</html>